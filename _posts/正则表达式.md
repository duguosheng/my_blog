---
title: 正则表达式
date: 2019-09-26 11:45:07
tags:
- 正则表达式
categories:
- 正则表达式
description: 用于快速匹配字符
---

<!--more-->
## python中使用正则表达式
```py
# 导入re模块
import re


# 使用match方法查看是否满足规则，如果匹配失败，返回None
# 字符串前加r表示这是非转义的原始字符串
ret = re.match(r"指环王[1-3]", "指环王2")
print(ret)

# 可以使用group方法查看匹配的对象
print(ret.group())
```

> 运行结果
```
<re.Match object; span=(0, 4), match='指环王2'>
指环王2
```

> `match()`方法默认判断开头


## 匹配单个字符

| 表达式 | 作用                                                                   | 示例                                                         |
|--------|------------------------------------------------------------------------|--------------------------------------------------------------|
| `.`    | 匹配任意一个字符，`\n`除外                                             |                                                              |
| `[]`   | 匹配`[]`中列举的字符                                                   | "[1-34-6a-nA-N]"(可以匹配1-3, 4-6, a-n, A-N之间的数字或字符) |
| `\d`   | 匹配一位数字，即1-9                                                    | "\d"(可以匹配0-9之间的一位数字)                              |
| `\D`   | 匹配非数字                                                             | "\d"(可以匹配0-9之间的一位数字)                              |
| `\w`   | 匹配单个字符，包括`0-9`，`a-z`，`A-Z`，`_`(下划线)其他语言中的单个字符 |                                                              |
| `\W`   | 匹配非单词字符，如一些特殊符号                                         |                                                              |
| `\s`   | 匹配空白字符，如`空格`，`tab`，`\n`等                                  |                                                              |
| `\S`   | 匹配非空白字符                                                         |                                                              |

## 匹配多个字符
| 表达式  | 作用                                               | 示例                                                             |
|---------|----------------------------------------------------|------------------------------------------------------------------|
| `{m}`   | 限制前面表达式的位数为m个                          | `\d{3}`表示必须是一个三位数                                      |
| `{m,n}` | 限制前面表达式的位数为m-n个，注意`,`后面不要有空格 | `\d{1, 3}`表示一个1-3位数                                        |
| `？`    | 指定前面的字符要么有一个，要么没有                 | `021-?\d{7}`表示`-`可有可无，如`021-1234567`或`0211234567`都满足 |
| `*`     | 匹配任意多个字符，可以为空                         | `.*`匹配所有字符                                                 |
| `+`     | 匹配任意多个字符，但不能为空                       |                                                                  |

> `.`默认是不匹配换行符的，如果想要匹配所有字符，可以与`*`连用并在`match()`方法中加一个参数`re.S`使之可以匹配换行，如
```py
re.match(".*", "some \n text", re.S)
```

> 当匹配中需要使用到`.`，`*`等作为普通字符，需要前面加转义字符，如`\.`，`\*`

## 匹配开头结尾
| 表达式 | 功能     |
|--------|----------|
| `^`    | 匹配开头 |
| `$`    | 匹配结尾 |

## 匹配分组
| 表达式       | 功能                                                                                                                                                      |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| &#124;       | 匹配左右任意一个表达式                                                                                                                                    |
| `(ab)`       | 1. 括号内的优先运算 2. 将括号中的字符作为一个分组，在python中根据括号的先后顺序，可分别使用`group(1)`，`group(2)`取出分组的数据，[使用演示](#()使用演示) |
| `\num`       | 引用第`num`组匹配到的字符串，[使用演示](#\使用演示)                                                                                                       |
| `(?P<name>)` | 分组起别名                                                                                                                                                |
| (?P=name)    | 引用别名为`name`分组匹配到的字符串，[使用演示](#别名使用演示)                                                                                             |

### `()`使用演示
```py
import re


def main():
    """输入邮箱用户名为4-20位"""
    email = input("请输入您的邮箱：")
    # 利用()设置分组，并且使或运算仅限于163与126
    result = re.match(r"^([0-9a-zA-Z_]{4,20})@(163|126)\.com$", email)
    if result:
        # 利用group取出分组的值
        print("您注册的用户名是{0}，邮箱类型是{1}邮箱".format(result.group(1), result.group(2)))
    else:
        print("格式错误，请重新输入")


if __name__ == "__main__":
    main()
```

> 执行程序
```
请输入您的邮箱：zhangsan_123@126.com
您注册的用户名是zhangsan_123，邮箱类型是126邮箱
```

### `\`使用演示
```py
import re


def main():
    print("请重复输入两次用户名和密码\n用户名与密码间以,间隔\n第一次和第二次间用;间隔")
    name_pass = input("==>")
    while True:
        result = re.match(r"^([a-zA-Z0-9]{3,10}),([a-zA-Z0-9]{6,16});\1,\2$", name_pass)
        if result:
            print("OK")
            break
        else:
            name_pass = input("请重新输入==>")


if __name__ == "__main__":
    main()
```

> 运行程序
```
请重复输入两次用户名和密码
用户名与密码间以,间隔
第一次和第二次间用;间隔
==>jack,123456;jack,654321
请重新输入==>jack,123456;john,123456
请重新输入==>jack,123456;jack,123456
OK
```

### 别名使用演示
* 上面的判断代码可以写为
```py
result = re.match(r"^(?P<name>[a-zA-Z0-9]{3,10}),(?P<pass>[a-zA-Z0-9]{6,16});(?P=name),(?P=pass)$", name_pass)
```


